Welcome to Gutenprint 5.0.1!  Please read these release notes
carefully.

Gutenprint, formerly named Gimp-Print, is a suite of printer drivers
that may be used with most common UNIX print spooling systems,
including CUPS, lpr, LPRng, or others.  These drivers provide high
quality printing for UNIX (including Macintosh OS X 10.2, 10.3, and
10.4) and Linux systems that in many cases equal or exceed proprietary
vendor-supplied drivers in quality and functionality, and can be used
for demanding printing tasks requiring flexibility and high quality.
This software package includes an enhanced Print plug-in for the GIMP
that replaces the plug-in packaged with the GIMP, and Ghostscript and
CUPS drivers, as well as Foomatic data supporting the Ghostscript
driver.

Gutenprint has been renamed in order to clearly distinguish it from
the GIMP.  While this package started out as the original Print plugin
for the GIMP, it has expanded into a collection of general purpose
printer drivers, and the new, enhanced Print plugin for the GIMP is
now only a small part of the package.  Furthermore, the name
Gutenprint recognizes Johannes Gutenberg, the inventor of the movable
type printing press.  Finally, the word "guten" means "good" in
German.

Gutenprint 5.0.1 is a stable release of Gutenprint 5.0, with bug fixes
and new features.

Gutenprint currently supports over 700 printer models.

These release notes contain the following sections:

I)    General Requirements
II)   Changes from Previous Releases
	A) Changes from 5.0.0 to 5.0.1
III)  Overall changes from 4.2 to 5.0.
	A) General user-visible changes
	B) New Functionality
	C) Changes to the Print plugin for the GIMP
	D) Changes to the CUPS interface
	E) Changes to the Ghostscript driver
	F) Changes to the Foomatic data generator
	G) Quality improvements
	H) Architectural Changes
IV)   Exceptions and Workarounds
	A) General Issues
	B) Build/Installation Issues


================================================================

I) GENERAL REQUIREMENTS

Gutenprint will run on any reasonably modern computer running Linux,
Macintosh OS X (10.2 or above), Solaris, or any other UNIX-like
operating system.  If you plan to compile this package from source,
you will also need an ANSI C compiler, such as gcc (recommended).  A
compiler is not required if you are installing a pre-compiled package.

Processor and memory requirements vary depending upon the printer and
runtime options selected; it is suggested that you have at least 64 MB
of memory for general purpose printing, 256 MB or more for high
quality printing on a good printer, and 1 GB or more for large format
printing at high resolution.  You should have at least 50 MB of free
disk space to compile and install Gutenprint.  Disk space requirements
for printing will vary depending upon how you use Gutenprint, but are
generally modest except as noted below.  We recommend a processor
speed of at least 300 MHz.  Fast printers may require a faster
processor to achieve maximum printing speed.

For general use, you should have the Common UNIX Printing System, CUPS
(version 1.1.15 or above) or Foomatic (2.0 or above) installed.
Please the rest of the release notes, in particular the Exceptions and
Workarounds, for full details on installation, as there is important
information to be aware of.  CUPS is the printing system used on
Macintosh OS X 10.2 and above, and many other systems use it.  The
combination of CUPS and Gutenprint provides a flexible, general
purpose printing system capable of producing the highest quality
output with any of the printers supported by this package.  We
strongly recommend using CUPS with Gutenprint as a general-purpose
printing solution.

The enhanced Print plug-in for the GIMP requires either the GIMP 2.0
or above, or 1.2.3 or above on the 1.2 line (1.2.5 is recommended).
This plug-in will work with any printing system, and offers a
comprehensive user interface to control all aspects of the printing
process.  If you are printing photographs in large format from the
GIMP at very high resolution, disk space requirements may be
substantial, and we recommend at least 2 GB of free disk space for
that purpose.

The Ghostscript driver requires GNU Ghostscript 6.53 or higher, ESP
Ghostscript 7.05 or higher, or AFPL Ghostscript 7.04 or higher.  It
uses the IJS package included with these versions of Ghostscript to
create a driver that may be built much more easily than traditional
Ghostscript drivers.  This driver should be used in conjunction with
Foomatic to configure printers.

Users of Macintosh OS X 10.2 (Jaguar), 10.3 (Panther), and 10.4
(Tiger) can use this package, as the printing system is based on CUPS.
For ease of installation, a pre-built package with installer is
normally supplied a few days after the release of the source package.
We strongly recommend that OS X users use the pre-built package rather
than attempt to build it themselves.

NOTE: This package will not work with any version of OS X 10.0 and
10.1 (such as 10.1.5).  The printing system used with these versions
of OS X is not compatible with Gutenprint.  OS X 10.2 and above use
CUPS as the basis of the printing system, which is compatible with
Gutenprint.

The README file included with this package provides full instructions
for building and installing Gutenprint.


================================================================

II) MAJOR CHANGES FROM PREVIOUS RELEASES

A) NEW FEATURES AND FIXES IN GUTENPRINT 5.0.1:

  1) New printers supported in this release:

     * Dye sublimation printers:

       The driver for these printers has been renamed "dyesub", as
       many of the printers are manufactured by companies other than
       Olympus.

       Canon CP-10
       Fujifilm FinePix NX-500
       Kodak Easyshare Printer
       Olympus P-S100
       Sony DPP-EX5
       Sony UP-DR100

     * Canon inkjet printers:

       The support for these printers is under development, and there
       are known issues with these printers.  Please check with the
       mailing list (gimp-print-devel@lists.sourceforge.net) if you
       have any questions.

       Canon PIXMA iP2000
       Canon PIXMA iP3000
       Canon PIXMA iP3100
       Canon PIXMA iP4100
       Canon PIXMA iP4200
       Canon PIXMA iP4300
       Canon PIXMA iP5000
       Canon PIXMA iP5200
       Canon PIXMA iP6700
       Canon MULTIPASS MP150
       Canon MULTIPASS MP500
       Canon MULTIPASS MP700
       Canon MULTIPASS MP730
       Canon MULTIPASS MP750
       Canon MULTIPASS MP760
       Canon MULTIPASS MP770
       Canon MULTIPASS MP780
       Canon MULTIPASS MP790
       Canon MULTIPASS MP830
       Canon PIXUS iP3100
       Canon PIXUS iP4100
       Canon i560
       Canon i850
       Canon i860
       Canon i865

     * Lexmark inkjet and compatible printers:

       Compaq IJ1200
       Lexmark X73

     * PCL laser printers (monochrome only):

       Lexmark Optra E220
       Xerox WorkCentre M118

  2) CUPS 1.2 is now supported using on-the-fly PPD file generation.
     In addition, the resolution names are all compliant with the PPD
     specification.  cups-genppdupdate correctly updates on-the-fly
     PPD files.

  3) The native CUPS driver offers a new Shrink Page If Necessary to
     Fit Borders option, enabling the user to choose how to fit the
     output to the imageable area of the page.  This is useful when a
     printer offers a choice of imageable areas, typically normal
     (which has margins) and full bleed (which allows printing to the
     edge of the paper, or even beyond).  The following options are
     available:

     * Shrink (default): the output is shrunk if necessary to fit the
       imageable area of the page.  If a printer is capable of
       borderless operation but normal margins are selected, the
       output will be shrunk.  This will print the entire page
       (nothing will be lost), but will not preserve the dimensions of
       the printout.  For example, a line intended to be 10 cm long
       may print smaller than that.

     * Crop: the output is cropped if necessary to fit the imageable
       area of the page.  The dimensions of the page will be preserved
       (a line intended to be 10 cm long will print out exactly 10
       cm), but the edges of the output may be truncated (cropped).

     * Expand: the output is expanded to fit the maximum possible
       imageable area of the page.  When selected on printers capable
       of full bleed output, in conjunction with any other necessary
       options, the output will be expanded to match the maximum page
       dimension.  The dimensions of the page will be expanded if
       necessary beyond the page size; a line intended to be 10 cm
       long may print longer than that.

     This option has no effect on printers not capable of full bleed
     or other expanded margins.  It also has no effect when printing
     to CD's or the like.

  4) Support for the GIMP 1.2 has been removed.

  5) An experimental PostScript driver has been added, enabling use of
     all PPD file options in the enhanced GIMP plugin.  This is a work
     in progress.

  6) Epson inkjet printers now correctly support borderless printing.
     In addition, printing at the top and bottom of the page has been
     improved on printers that support borderless printing, although
     this is still not perfect in all cases.

     Certain printers (in particular the C/D8x and C6x series) do not
     print correctly to the bottom of the page with all colors.  This
     problem is understood, but we do not know when a fix will be
     available.

  7) The list of resolutions supported on newer Epson printers has
     been changed; resolutions of 5760x1440, 2880x2880, and 5760x2880
     (as appropriate) have been added, replacing various 1440x2880
     enhanced resolutions.

  8) The output for the Canon PIXMA printers has been improved.

  9) The Canon driver now supports DuplexNoTumble for the PIXMA
     iP4000.

 10) Roll printing now works correctly on the Epson Stylus Photo
     R800.


================================================================

III) OVERALL CHANGES BETWEEN GIMP-PRINT 4.2 AND GUTENPRINT 5.0:

A) GENERAL USER-VISIBLE CHANGES:

  1) Gutenprint offers many new options, which are described
     separately below.  Many other options that are present in both
     4.2 and 5.0 function differently between the two releases.

  2) Options in the CUPS driver and GIMP plugin are now grouped
     according to function.  This work is still in progress, and
     we expect to make further usability improvements.

  3) Simplified bundles of settings are now offered for users who do
     not need to customize the settings.  The Print Quality and Image
     Type controls offer a variety of settings optimized for common
     printing tasks; these settings may be overridden by explicit user
     choice.

  4) Many of the color settings have changed effect.  We recommend
     starting with no color adjustments and making appropriate changes
     only as required.  Specific changes that you should be aware of
     include:

     * The default operation of the contrast setting has changed to be
       more in accord with other packages.  In 4.2, reducing the
       contrast resulted in changing the black and white setting.  In
       5.0, reducing the contrast does not change the black and white
       settings.  As a result, it is possible to use the contrast
       setting to improve highlight and shadow detail by reducing the
       contrast.

       The previous behavior is available by turning on the "Linear
       Contrast Adjustment" setting.

     * The brightness control now behaves more in accord with standard
       practice, adjusting the image's overall brightness without
       changing the black or white points.

     * The Cyan, Magenta, and Yellow settings have been replaced with
       separate settings for gamma, density, and gray balance for
       Cyan, Magenta, Yellow, and Black.  The Cyan, Magenta, and
       Yellow settings in Gimp-Print 4.2 most closely correspond to
       the gamma settings in 5.0.

       The per-channel density settings do not affect the color
       correction.  They are applied after the color correction to
       scale the individual channels.  The per-channel gray balance
       settings adjust gray balance without affecting per-channel
       density settings (i. e. the adjust the amount of ink used to
       generate gray), permitting increased color saturation without
       compromising gray balance.

  5) The Uncorrected color correction mode is recommended for users
     who wish to use their own color (ICC or otherwise) profiles with
     Gutenprint drivers.  This will yield the maximum gamut and most
     uniform response.  If you are not using your own color
     management, you will generally get best results from the High
     Accuracy color correction setting.  Users who wish to perform
     their own linearization and ink limiting may wish to use the Raw
     color correction mode, which does not adjust the density.

     Any profiles generated against Gimp-Print 4.2 are unlikely to
     produce good results with Gutenprint 5.0.  The color generation
     is sufficiently different that you will need to create new
     profiles against Gutenprint 5.0.  In general, color adjustment
     should not change between Gutenprint 5.0 releases starting with
     release 5.0.0.  Color adjustments may change during beta
     (5.0.0-beta) and release candidate (5.0.0-rc) phases.

  6) The old man pages, and src/ghost/README, have been withdrawn.
     These pages, and the Ghostscript README file, were based on the
     Gimp-Print 4.2 options, which were much less extensive than the
     current option system.  It is not practical to keep them up to
     date in any meaningful way.  Our recommendation is that people
     use either the native CUPS driver or Foomatic to manage options
     rather than attempt to create and manage printer queues by hand.

  7) The source browser in the documentation package has been removed.
     This information, which consists of color-coded annotation of the
     source code, is of little interest to the vast majority of users
     and consumes a significant amount of space in the installation.


----------------

B) NEW FUNCTIONALITY:

  1) This release offers a new "curve" data type, permitting very
     precise adjustments of output.  Currently the curves are only
     accessible in the GIMP plugin.

  2) This release offers many new output controls:

     + Balance (density) controls for each color channel, in addition
       to the gamma controls present in 4.2.

     + Gray balance controls for the cyan, magenta, and yellow
       channels.  These controls allow fine tuning of gray tones
       without affecting color.

     + Black (GCR) transition, including the transition gamma and the
       upper and lower limits.

     + Transitions for photo (light cyan, light magenta, and gray)
       inks.

     + Transfer curves for each channel (cyan, magenta, yellow, black,
       and composite), allowing very precise control over the output.

     + Transfer curves for generation of additional channels where
       applicable, such as red and blue inks for the Epson Stylus
       Photo R800 and R1800.

     + Hue, saturation, and luminosity transfer curves permit tuning
       of the color corrections utilized by Gutenprint.

     + Ink limit control.

     + The density control now permits setting density as high as 8.0,
       vs. 2.0 in 4.2.

  3) The Epson driver offers (almost) true full bleed for printers
     that support it (but see the limitations below).

  4) The PCL driver now offers duplex (two sided) printing support on
     appropriate printers.

  5) The package now includes support for a number of dye sublimation
     photo printers made by Olympus, Canon, Sony, and Fujifilm.

  6) The resolution list for Epson printers has been simplified; many
     redundant resolutions have been removed.

  7) Print head direction for Epson printers (unidirectional
     vs. bidirectional) is now a separate control.  In addition to
     contributing to the simplification of the Epson printer
     resolutions, this permits the choice of unidirectional
     vs. bidirectional at all resolutions if desired.  By default, the
     driver picks the most appropriate choice for the situation.

  8) The Epson driver now allows printing directly to CD's on printers
     that support this functionality.  In addition, a choice of center
     hole size (16 mm or 43 mm) is now offered.  A fine adjustment is
     provided to permit control over positioning of the image on the
     CD.  This fine adjustment setting is not available in the
     Foomatic interface at present.

     To print to a CD, you need to select the "Print to CD" media
     source (input slot).  You must also select the appropriate page
     size (3" CD or 5" CD).  Note that this is different from the
     instructions Epson provides, which specify A4 media size.

  9) The Epson driver now offers a choice of print head weave
     patterns.  In addition to simplifying the resolution choices for
     Epson Stylus Pro printers, this offers an additional control for
     fine tuning output quality.

  10) The Epson driver offers an Ink Set control for printers taking
     different choices of inks (such as the Epson Stylus Photo 2200,
     which offers a choice of Matte Black and Photo Black inks).

  11) Where practical, all controls offer a default setting for
     simplicity of operation.  This default value is intended to offer
     the optimal choice given the printer and its other settings.  For
     example, if "Automatic" is selected for print head direction, the
     print head motion will be unidirectional at high resolutions
     (since unidirectional usually produces better output), but
     bidirectional at low resolutions (for faster printing).

     The default is only offered for options that are not directly
     controlled by the user's action.  For example, there is no
     default choice offered for paper type, since the correct value is
     based on the paper type loaded by the user.  Similarly, there is
     no default for the input slot or ink set.

  12) Support for a variety of input types, in both 8 and 16 bit
     resolution, has been added.  Gutenprint can now handle input in
     grayscale, whitescale (inverted grayscale), RGB, CMY, CMYK, and
     KCMY in 8 and 16 bit resolutions for all output types.

  13) A new Threshold color correction mode has been added that
     produces either all-on or all-off of each color.  This is similar
     to the Monochrome mode in 4.2, except that it works for color as
     well as black.

  14) A new Desaturated color correction mode has been added that
     produces gray (desaturated) output using color inks.

  15) A new Density color correction mode has been added that corrects
     only for density.  This will normally produce excessively dark
     output.  However, applications that wish to use their own
     linearization curves may wish to use this interface to prevent
     Gutenprint from performing its own linearization.

  16) A new Raw color correction mode has been added that performs no
     correction whatsoever on the input.  This mode may be used by
     applications that wish to perform their own ink limiting and
     linearization, and use Gutenprint to perform dithering
     (screening) and output generation only.

  17) A new Predithered color correction mode has been added that
     combines the effects of Raw and Threshold.  This mode may be used
     by applications that wish to perform their own dithering and use
     Gutenprint to generate printer-specific output only.  The input
     value should be the size of the drop desired (for single-level
     printers, it should be 0 or 1; for printers with three drop
     sizes, it should be 0, 1, 2, or 3).

  18) A new Correct Hue Only color correction mode has been added that
     performs partial color correction (adjusts hue, but not
     darkness).

  19) The escputil command, which performs various printer
     administration activities on Epson Stylus printers, has a number
     of improvements:

     * A new extended ink information command has been added.  This
       command, which is supported on printers with separate
       individual ink cartridges, prints additional information about
       the ink cartridge in addition to the amount of ink present.  On
       older printers, it simply returns the standard ink
       information.

     * The status command now prints status in a human-readable format
       rather than simply reporting the raw information returned by
       the printer.

     * Ink level detection now works on all known supported printers,
       and may work on other non-supported printers.  Previously it
       did not work on some newer printers.  However, it is somewhat
       slower on these printers than it is on older printers that
       support the faster ink detection method.

     * Ink level detection now prints the correct ink color names for
       the printer model.

     * It is now no longer necessary to use the -u flag with certain
       printers in most cases.  The utility now autodetects the
       printer model and generates appropriate commands in all cases.

       If you supply a printer queue (with the -P option) rather than
       a raw device (with the -r option), you will still need to
       provide the -u flag, as the utility cannot detect the actual
       printer connected to a queue.  However, commands that must be
       run bidirectionally (ink level, identify, and printer status)
       do not require the -u flag any more.

     * escputil now successfully detects ink level, printer model, and
       status even if the printer is out of ink.

  20) The Epson driver permits adjusting the dot size if required to
     increase the amount of ink printed.  For example, if 1440x720 DPI
     is selected, but the density requested is very high, the printer
     will switch to using drop sizes appropriate for 720 DPI.  This
     option is not normally required and is disabled by default.


----------------

C) CHANGES TO THE ENHANCED PRINT PLUGIN FOR THE GIMP:

  1) A new plugin for the GIMP 2.x, enhanced with all new Gutenprint
     5.0 functionality, is now provided.

  2) The Print plugin for the GIMP 1.2 is now deprecated and will be
     withdrawn in 5.1 (the development release following 5.0).  The
     Print plugin for the GIMP 1.2 will continue to be supported with
     critical bug fixes in all 5.0 releases, but no new functionality
     will be added, or non-critical bugs fixed, following the release
     of 5.0.0.

  3) The plugin now always displays the page preview with the top of
     the page at the top of the preview pane, rotating the image
     preview as necessary to display landscape or portrait mode.

  4) The positioning controls have been simplified.

  5) The printrc file format is different.  Gutenprint 5.0 can read
     printrc files created by Gimp-Print 4.2 and earlier, but it
     writes out the printrc file in a format that earlier versions of
     Gimp-Print cannot read.

  6) Printer queue discovery and command specification are greatly
     simplified over 4.2.  The plugin now offers a default printing
     command that is determined based on the characteristics of the
     system, and also offers the choice of printing to a file or using
     a custom print command for each printer defined in the printrc
     file.  The default printing command is correct whether the output
     is Postscript or not; it is no longer necessary to remove "-oraw"
     from the print command line.

  7) The Print plugin now always displays all options relevant to
     what's being printed, enabling and disabling options as
     appropriate.

  8) The plugin now lists printers grouped by manufacturer, rather
     than a single long list.

  9) If you are using an older version of the GIMP 1.2, and the GIMP
     is installed in a non-standard location on your system such that
     you cannot run configure in Gutenprint without using
     --with-gimp-prefix or --with-gimp-exec-prefix, please read item
     (8) in Exceptions and Workarounds below.  In addition, if you
     have both the GIMP 1.3/2.0 and the GIMP 1.2 installed on your
     system, you should read the same material.


----------------

D) CHANGES TO THE CUPS INTERFACE:

  1) The CUPS PPD files now offer both fine and coarse adjustments for
     all color controls, permitting much finer control over output (in
     steps of .005 rather than .05) without making the menus unwieldly.

  2) The CUPS driver refuses to function with PPD files created for a
     different version of Gutenprint or Gimp-Print, providing an error
     message indicating the problem.  This avoids problems caused by
     mismatches between the PPD files and the driver.  While
     mismatches are potentially not harmful in all cases, they could
     cause problems ranging from failures to print with poor
     diagnostic messages to incorrect results.

  3) The Gutenprint 5.0 CUPS driver can be installed concurrently with
     the 4.2 driver.  Both the PPD files and the driver carry
     different names from their 4.2 counterparts, permitting a
     parallel installation or gradual switchover between 4.2 and
     5.0-based releases.

  4) An update script (cups-genppdupdate.5.0) is provided to update
     PPD files between later 4.3 and 5.0-based releases, preserving
     option values where possible.  This script will not update PPD
     files based on Gimp-Print 4.2, or Gimp-Print 4.3 releases prior
     to 4.3.21.

  5) On printers capable of borderless output, the CUPS driver now
     advertises (via the *ImageableArea in PPD files) the full page
     dimension, and crops the output if the borderless mode is not
     selected.  If borderless mode is selected, the full image (up to
     the limits of the printer) will be printed.

     This compromise is necessitated by the fact that PPD files can
     only supply a single imageable area for a particular page size,
     so it was necessary to select which imageable area to provide.
     In early prereleases of Gutenprint 5.0, we supplied the normal
     page area, and stretched the output if the user selected full
     bleed.  This caused problems for many users, in that it was not
     possible to print the full surface of the paper while preserving
     dimensions.

     Based on user feedback, we determined that the best solution is
     to provide the full page size as the imageable area and crop the
     result if full bleed mode is not selected.

  6) The CUPS driver now offers 16-bit printing as an option with ESP
     Ghostscript 8.15, and Apple Macintosh OS X 10.4 ("Tiger"), using
     the new Color Precision control.  Setting Color Precision to
     "Best" enables 16-bit printing if the system supports it; setting
     it to "Normal" uses 8-bit printing.  Setting Color Precision to
     "Best" has no effect if the version of CUPS does not support
     16-bit printing; in that case, "Best" is still 8-bit.

     The higher precision may improve results with certain source
     material, particularly if it contains smooth color gradients.
     The result would be freedom from banding, particularly in
     highlights where it might be visible with 8-bit color
     computation.  It may be somewhat slower than 8-bit printing.

  7) Due to the implementation of CUPS, it is necessary on some
     systems to link the programs associated with the CUPS driver (in
     particular, cups-genppd and rastertogutenprint) statically
     against the Gutenprint library.  Please see bugs 865253 and
     865265 for full details.

     This fix works correctly unless --disable-static (to disable
     building static libraries) is passed on the command line.
     Normally, only people packaging up Gutenprint for distribution
     use this option.  If you wish to use this option, please read
     item (6) in Exceptions and Workarounds *carefully* for a full
     description of the problem along with suggested methods of
     procedure.


----------------

E) CHANGES TO THE GHOSTSCRIPT DRIVER:

  1) The stp driver, a monolithic (traditional) Ghostscript driver
     used with Ghostscript 5.10, 5.50, and 6.51, has been withdrawn.
     The only supported Ghostscript driver is the IJS-based driver,
     for GNU Ghostscript 6.53 and above, ESP Ghostscript 7.05 and
     above, and AFPL Ghostscript 7.04 and above.

     This change was made due to the difficulty of supporting the
     monolithic driver and the complexity of building it.  The
     traditional monolithic driver architecture required that all
     drivers be compiled into Ghostscript, requiring that program to
     be recompiled whenever a driver is added.  This is a rather
     complicated operation that cannot easily be automated.  The IJS
     architecture, based on the open source HPIJS driver supplied by
     Hewlett-Packard for HP inkjet printers, allows for drivers to be
     compiled independently of the core Ghostscript.  A
     Gimp-Print/Gutenprint driver based on the IJS architecture was
     introduced into Gimp-Print 4.2.1 and 4.3.0, and has been
     recommended for use with Gimp-Print 4.2.2 and beyond.

     In addition to a greatly simplified build procedure and overall
     cleaner architecture, the separation between Ghostscript and
     driver imposed by the IJS architecture permits use of Gutenprint
     with AFPL Ghostscript with no license conflict.


----------------

F) CHANGES TO FOOMATIC DATA GENERATION:

  1) The Ghostscript IJS driver now functions only with Foomatic PPD
     files created for the matching version of Gutenprint, providing
     an error message indicating the problem if an incorrect PPD file
     is used.  This avoids problems caused by mismatches between the
     PPD files and the driver.  While mismatches are not harmful in
     all cases, they could cause problems ranging from failures to
     print with poor diagnostic messages to incorrect results.

  2) The Gutenprint 5.0 Foomatic data and IJS driver can be installed
     concurrently with the 4.2 driver.  Both the PPD files and the
     driver carry different names from their 4.2 counterparts,
     permitting a parallel installation or gradual switchover between
     4.2 and 5.0-based releases.

  3) On printers capable of borderless output, the Foomatic driver now
     advertises (via the *ImageableArea in PPD files) the full page
     dimension, and crops the output if the borderless mode is not
     selected.  If borderless mode is selected, the full image (up to
     the limits of the printer) will be printed.

     This compromise is necessitated by the fact that PPD files can
     only supply a single imageable area for a particular page size,
     so it was necessary to select which imageable area to provide.
     In early prereleases of Gutenprint 5.0, we supplied the normal
     page area, and stretched the output if the user selected full
     bleed.  This caused problems for many users, in that it was not
     possible to print the full surface of the paper while preserving
     dimensions.

     Based on user feedback, we determined that the best solution is
     to provide the full page size as the imageable area and crop the
     result if full bleed mode is not selected.


----------------

G) QUALITY IMPROVEMENTS:

  1) Color and tonal accuracy is greatly improved compared to 4.2
     while the gamut (range of printable colors) has been increased.
     This particularly improves the hue accuracy of red, magenta, and
     blue, and the tonal accuracy of cyan and green.  Most Epson
     printers have been fully tuned for the new color correction
     algorithms introduced for this release.

     The default gamma has been changed to produce lighter midtones
     with all Epson printers.

  2) The handling of variable drop sizes and photo inks (6 and 7 color
     printers) has been completely revised, with the result being that
     variable drop size printers with photo inks (such as most Epson
     Stylus Photo and Stylus Pro printers) give much more consistent
     results with fewer artifacts.  In particular, colors match
     correctly across all resolutions, which was not the case in 4.2.

     In 4.2, variable size drops and light inks were treated the same
     way; an "effective drop size" based on the relative size of the
     drops and the darkness of the inks was used to decide what kind
     of drop to print.  While this method has some advantages (it
     ensures that dark and light inks are never printed at the same
     place, and also that dark dots are optimally dispersed among
     light dots), it has some serious disadvantages as well: the
     properties of a small dark dot and a large light dot are not
     really the same, particularly when inks are mixed.  The
     combination of different drop sizes being used at different
     resolutions meant that the transition between light and dark inks
     differed depending upon the resolution chosen, and if more than
     one drop size was required at a given resolution, the transition
     tended to be quite marked.

     The new method of handling variable size drops and light inks is
     to first separate each of the four channels (cyan, magenta,
     yellow, and black) into the appropriate light and dark inks, if
     needed.  This separation is performed based on the relative
     darkness of the different ink sub-colors (such as light and dark
     cyan) and specific characteristics of the printer, ink type, and
     paper chosen.  Following this, each sub-color is screened
     separately, and the appropriate combination of drop sizes is
     chosen.

     The drop size selection in this release has also been changed to
     fill the page with as many small drops as possible before
     switching to larger drops.  This ensures that the largest number
     of the smallest possible drops is printed, which yields a
     smoother texture in the midtones.

     Finally, new dither algorithms described below allow drops of ink
     of different colors to be dispersed, avoiding clumping or
     overprinting of drops.

  3) The EvenTone dither algorithm has been extensively reworked in
     this release, offering many improvements.

     First, it has been rewritten to work correctly with variable drop
     size and photo printers.  This algorithm, which offers
     significant improvements over the standard Adaptive Hybrid
     algorithm, does not work optimally with variable drop sizes or
     photo printers in 4.2.

     Secondly, a variation called Hybrid EvenTone has been added.
     This dither algorithm perturbs the dot positions slightly to
     break up some patterning seen in standard EvenTone dithering in
     solid regions of pale tones, particularly when printing with
     black ink only.  This very slightly reduces the smoothness of
     texture in exchange for largely eliminating this undesirable
     patterning.  This algorithm is also expected to be more resistant
     to microbanding effects.

  4) The conversion between black and composite (CMY) gray has been
     improved in this release, yielding more neutral grays on most
     printers.

  5) Epson printers have been completely retuned, in most cases
     yielding much better density, more accurate gray scale, and
     darker black on all paper types.


----------------

H) ARCHITECTURAL CHANGES:

  1) Family drivers are now modular.  A "family driver" is a
     collection of printer drivers for one group of printers sharing a
     common programming architecture, e. g. ESC/P2, PCL, Lexmark,
     Canon.  The drivers can be built as separate modules and loaded
     at runtime as needed.

  2) Color processing is now partially modularized.  This architecture
     will enable us, or others, to provide color management without
     having to change the internal interfaces within Gutenprint.

  3) New composite data types.  Gutenprint 5.0 defines additional data
     types.  These types include:

     * Sequences, curves, and arrays.  A sequence is a primitive
       vector of numbers data type; curves and arrays provide
       additional capabilities such as interpolation (for curves) and
       multiple dimensions (for arrays).

     * Lists are a general ordered container of named objects of
       arbitrary type.  They are used throughout the core library in a
       variety of ways.  The creator of a list can specify
       constructor, destructor, name comparison, copy, and sort
       operations on list members.

     * Parameters, which are part of the options system described
       below.  In addition to storing values and descriptions of the
       parameter, parameters can be queried to determine defaults and
       constraints.  Parameter lists (which use the list container
       internally) are also defined as part of this.

     * String lists are used in various ways; in particular, they are
       used by the parameter system to inform programs of the
       available choices of values for string-valued parameters.

  4) Complete overhaul of the options system.  Rather than offering a
     fixed set of operations, family drivers, color modules, etc. can
     now offer a wide variety of options using a predefined set of
     data types.  The data types currently supported are strings
     picked from a list, floating point numbers, integers, curves,
     arrays, Boolean values, dimensions, and filenames.

     The new options system provides a flexible way for drivers to
     inform applications of default values and UI hints, the ability
     to selectively enable and disable options, and a generalized way
     of verifying legality of option choices.

  5) The coordinate system has been changed from bottom left to top
     left of the page, and the printable area can now extend beyond
     the edge of the page.  The result is a more intuitive coordinate
     system for driver writers that matches the coordinate system of
     printers, and the ability to do true full bleed.

  6) The specification of color correction, input, and output modes
     has been completely revised, permitting applications to specify
     input mode, output mode, channel bit depth, and color correction
     completely independently.  This architecture is also more
     extensible.

  7) Complete overhaul of the black generation in CMYK output.  Black
     generation is now performed in the color code rather than the
     dither code.  This simplifies the dither code, puts the CMYK
     generation where it should be, and improves overall flexibility.

  8) Complete overhaul of the multi-tone (photo or quadtone) ink
     processing architecture (channels).  Instead of being processed
     as part of the dithering code as in 4.2, where ink drops of
     lighter inks were assigned virtual values proportional to their
     darkness as well as their size, this is now processed after the
     initial color conversion.  This has a number of major advantages:

     * As the actual amount of ink to be printed is visible to the
       color code, the color code can do ink limiting without fear
       that the dither code will change the amount of ink to be
       printed.

     * It ensures that the same proportions of inks will be printed at
       any density and resolution.  In 4.2, the ramp from light to
       dark ink varied depending upon the dot sizes available and
       hence the resolution.  This has already been demonstrated to
       yield much better linearity and much more neutral gray scale
       with even very modest tuning effort.

     * It enables use of all drop sizes of all ink tones.  In 4.2, we
       could not use the smallest drop size of dark ink, because the
       virtual dot size of a small dot of dark ink is typically close
       to the virtual dot size of a large dot of small ink.  This
       would yield very sharp transition, and perhaps even result in
       more light ink printed in darker regions than in lighter
       regions.  With channel processing separate from dithering, this
       concern no longer exists; we can safely use small drops of dark
       ink, improving smoothness.

     * It enables the color code to do ink limiting intelligently
       without concern that the dither code will rearrange things
       behind its back.

     * It greatly simplifies the specification of inks.  With drop
       size and darkness orthogonal, family drivers can greatly
       simplify their tables of inks.

     * Dither algorithms can choose to ignore smaller drop sizes if
       they wish to offer fast operation.

     * Applications with special requirements can now access the raw
       ink channels directly.  This facility was used to create a
       mechanism to more accurately tune printer inks.

  9) The color system can now generate arbitrary ink colors, lifting
     the CMYK-only restriction in previous versions of the package.
     This permits full support for the Epson Stylus Photo R800 and
     R1800, which use red and blue ink in addition to the traditional
     CMYK.

  10) Use of true XML to store data about printers and paper sizes, and
     to represent new data types (sequences, curves, and arrays).
     This uses the "mxml" XML library, a fast, lightweight XML parser
     written by Mike Sweet for this project.  Currently, the use of
     XML (as opposed to compiled-in data) is limited, but we expect
     that this will change beyond the initial 5.0 release.

  11) In addition to parameters, internal components such as family
     drivers, color drivers, etc. can store arbitrary data in the
     basic stp_vars_t object.  This facility is used to simplify the
     internal driver API; the family driver no longer needs to keep
     track of dither, color, etc. information itself.

  12) The Epson Stylus family driver has been decomposed into more
     functionally distinct units.  The data schema has been
     considerably improved, and the code itself broken into more
     easily maintained units.

  13) The build system has been updated with a more contemporary
     toolchain based on autoconf 2.5 and gettext 0.11.

  14) The Print plugin for the GIMP has been decomposed into a UI
     library and the core plugin.  The user interface library is a
     pure GTK-based library; the tiny GIMP plugin is a client of this
     library.

  15) Printer characteristics are exposed to the application level as
     read-only parameters.  This permits the escputil utility to not
     duplicate information stored in the printer driver.


================================================================

IV) EXCEPTIONS AND WORKAROUNDS

A) GENERAL ISSUES

  1) The Canon, Hewlett-Packard, and Lexmark drivers do not offer all
     of the additional options and improvements that the Epson driver
     does.  We do not have an estimated time for fix.  Please contact
     us if you would like to assist with this.

  2) This release is slower than 4.2 in many cases, particularly when
     using High Accuracy (which is the default color correction in
     most cases) or Bright color correction.  It is possible that this
     release will not be able to drive some printers at full speed,
     particularly if your computer has a slow processor.  Performance
     has been only partially analyzed or tuned at present.


----------------

B) BUILD/INSTALLATION ISSUES

  1) With certain versions of CUPS and in certain non-default
     configurations, if a new version of Gutenprint is installed over
     an existing version genppd will create PPD files based on the
     older version of Gutenprint rather than the newer version.  This
     will happen if all of the following are true:

     i) The cups-config provided by the CUPS driver adds
        -Wl,rpath=/usr/lib. This is done by some versions of CUPS
        reportedly because in some cases the runtime linker does not
        pick up libraries out of /usr/lib.  This can be checked by
        running

        cups-config --libs --ldflags

        and inspecting the output for any mention of "rpath", "RPATH",
        "RUN_PATH", or the like.  This is controlled by the CUPS
        installation on your system.

     ii) There is presently a version of Gutenprint installed in /usr
        (--prefix=/usr) rather than /usr/local or the like.  The
        default location of Gutenprint installation is in /usr/local,
        but system vendors typically install Gutenprint in /usr.

     iii) Gutenprint is built dynamically only (--disable-static or
        --disable-static-genppd).  This is not a default, and requires
        the explicit --disable-static or --disable-static-genppd on
	the Gutenprint "configure" command line.  Therefore, if you
	build Gutenprint normally you should not be vulnerable to this
	problem.

     Note that in general if you install CUPS into a non-standard
     location, and install Gutenprint into the same location, this
     problem can surface.  For example, if you choose to install CUPS
     in /usr/local and Gutenprint in /usr/local you are vulnerable to
     this.  However, it is not standard practice to install CUPS
     anywhere but /usr.

     In this case, the run path embedded in the genppd executable
     points to the version of Gutenprint installed in /usr/lib.  This
     run path overrides any attempt by libtool to look in the build
     directory.  The result is that cups-genppd and rastertogutenprint
     are run against the older version of Gutenprint.  If the new
     version contains additional features (more printers, changes to
     printer options, etc.) they will not be available.

     This bug is difficult to detect in a normal build.  It normally
     does not cause an error to happen during build unless there is an
     API change from the version installed and the version being
     built; the only failure is frequently that some PPD files may not
     be built or may be built with missing options.  Due to the PPD
     version checking introduced in this release, the behavior might
     manifest itself as a runtime error.  It is also possible that
     there will be no error at all other than the older version of
     Gutenprint being used, with the result that new features and bug
     fixes are not available.

     If you wish to use only shared libraries, do not wish to build
     static libraries at all, and are vulnerable to this issue
     (because cups-config --ldflags sets the run path), there are
     three workarounds available:

     i) Build and install Gutenprint into /usr (rather than
        /usr/local) and then rebuild Gutenprint from scratch.  This
        will install the correct libgutenprint.so in /usr/lib, and in
        the rebuild genppd will be run against the correct library.

     ii) Remove the old version of Gutenprint prior to building the
        new version of Gutenprint.  The important files to remove are
        anything named /usr/lib/libgutenprint*.

     iii) Edit cups-config to remove the reference to the run path.

  2) There is a known translation problem building the PPD files used
     by the CUPS driver such that on many systems all of the PPD
     files are in the English language.  This causes CUPS tools, such
     as KUPS or http://localhost:631 to display many copies of each
     PPD file, all in the English (en) language.  In fact, the PPD
     files should be translated into many different languages.

     The PPD files are created by a program named "genppd" in the
     src/cups directory.  This program is called once for each
     language, and creates all of the PPD files for the language in
     one shot.

     The command 'zgrep' can be used to determine if genppd is
     creating the PPD files correctly, as follows:

	 src/cups$ zgrep LanguageVersion ppd/*/pcl-4.ppd.gz
	 ppd/C/pcl-4.ppd.gz:*LanguageVersion: English
	 ppd/da/pcl-4.ppd.gz:*LanguageVersion: Danish
	 ppd/en_GB/pcl-4.ppd.gz:*LanguageVersion: English-GB
	 ...

     If the PPD file for each language has a different language
     version, the genppd program operated correctly.  If instead the
     output looks like this:

	 src/cups$ zgrep LanguageVersion ppd/*/stp-pcl-4.5.0.ppd.gz
	 ppd/C/stp-pcl-4.5.0.ppd.gz:*LanguageVersion: English
	 ppd/da/stp-pcl-4.5.0.ppd.gz:*LanguageVersion: English
	 ppd/en_GB/stp-pcl-4.5.0.ppd.gz:*LanguageVersion: English
	 ...

     the program did not operate correctly.

     If you do not have 'zgrep' on your system, you can gunzip the
     PPD files, and use

	 grep LanguageVersion ppd/*/stp-pcl-4.5.0.ppd

     to accomplish the same test.

     The normal mechanism for performing translations is to set the
     LANG environment variable to the appropriate language prior to
     running the program.  This normally causes the program to search
     the translations (normally in /usr/share/locale or
     /usr/lib/locale) for the chosen language.  When a specially
     marked string is used, a special macro calls `gettext()' on the
     string to retrieve the translation, and substitutes the
     translation for the string in question.

     There are two problems with this approach in the context of
     genppd.  The translation engine is intended to be used after
     installation, not during build, and this causes problems.

     i) At the time genppd is run, the translations have not been
	installed in the normal system directories.  Fortunately,
	it's possible to tell the translation machinery (via
	bindtextdomain) to look elsewhere for the translation
	catalogs.  What we do is install the catalogs in a temporary
	directory under src/cups, and tell genppd to instruct the
	translation machinery to look there.  This workaround is
	straightforward, and doesn't normally cause problems.

     ii) LANG only lets us pick a valid locale (normally determined by
	listing the directories in /usr/share/locale or
	/usr/lib/locale).  Unfortunately, while language codes (which
	form the base of locales) are standard, the actual locale
	names aren't always.  On some systems, the locale names are
	just the language base names; on others, they are the
	language names concatenated with country codes (e. g. en_US),
	while on others they are language codes concatenated with
	character sets.  We are not aware of any workaround for this,
	possibly short of actually running make install and then
	rebuilding the PPD's.  'make install' will install the
	message catalogs, and that may create the necessary locale
	directories.  This is not exactly a very elegant approach.

     The GNU gettext library (libintl.a) provides another environment
     variable, LANGUAGE, which unconditionally looks up translations
     according to the language, ignoring LANG and the LC_*
     environment variables that are normally used for translation.
     This library is no longer included with Gutenprint
     (--with-included-gettext will not work).  Install the GNU
     gettext package first if you need libintl.a.  Many systems
     provide translation machinery in their standard libraries, and
     it may not always be best to use foreign libraries to replace
     standard system functionality.

     We have chosen to use LANGUAGE for this purpose, as the GNU
     gettext library appears to offer the most reliable translation,
     and LANGUAGE appears to offer the most reliable mechanism.  We
     have actually found that LANG and LC_* can interfere with
     LANGUAGE, thus we do not use both.

     To determine if the translations are working, you must actually
     inspect the PPD files.  You will need to

     cd src/cups/ppd/sv
     gunzip *
     more *

     or the like to determine if this is successful.  In particular,
     look for LanguageVersion, and make sure that it is correct (it
     should be "Swedish" in the sv directory, for example), and also
     make sure that the paper sizes are also translated.  We
     currently suggest using the Swedish translation for this purpose
     as it is the most complete.

     If packagers find that the PPD files are all in English, rather
     than translated into the appropriate languages, we suggest the
     following:

     i) Install GNU gettext (libintl).  If your system is not based
	on GNU libc (Linux usually is based on GNU libc; BSD,
	Solaris, IRIX, etc. are not), you will need this to have any
	possibility of creating the translated PPD files.

     ii) Run 'make install' to install the package (including the
	message catalogs) onto the system first, and then do the
	following:

	cd src/cups
	rm ppd-stamp
	make

	to rebuild the PPD files.  Having the message catalogs on the
	system may permit this to succeed.

     iii) Ensure that your system actually has locales named 'sv',
	'pl', and all of the other supported languages, and change
	LANGUAGE to something more appropriate (most likely LANG,
	LC_MESSAGES, or LC_ALL).

     iv) Build the PPD files on a Linux-based system; they are
	portable.

     v) Use --disable-translated-cups-ppds on the configure command line
	to suppress the translated PPD files altogether.

     Please feel free to contact us about this issue.

  3) There are multiple issues that one must be aware of when using
     Foomatic with Gutenprint.

     i) Before installing any new release of Gutenprint 5.0, you must
	manually remove any existing Foomatic option files.  This is
	because the Foomatic utility to load data kits
	(foomatic-kitload) does not remove obsolete data files from
	the Foomatic database.  If you do not do this, any PPD files
	you generate will be incorrect and printing may work
	incorrectly or not at all.

	Foomatic option files are usually located in

	/usr/local/share/foomatic/db/source/opt

	or

	/usr/share/foomatic/db/source/opt

	Assuming they're in the former location, you must remove data
	files associated with the Gutenprint driver.  The command to do
	this, which must be run as the superuser (root) is

	cd /usr/local/share/foomatic/db/source/opt
	ls -l gutenprint-ijs*.xml

	If there are existing files present, you must remove them:

	rm -f gutenprint-ijs*.xml

	Now check to make sure that they are gone:

	ls -l gutenprint-ijs*.xml

	CAUTION: Be very careful when typing this command!  Minor
	errors in typing these commands may result in severe damage to
	your system.

	After this, you may run 'make install' in your Gutenprint
	source directory to install the package.  You will then need to
	re-create any printer queues using Foomatic.

	In general, you will have to perform this procedure any time
	you install a new version of Gutenprint.

	Please check the Foomatic site
	(http://www.linuxprinting.org/foomatic.html) and the Gutenprint
	site (http://gimp-print.sourceforge.net) for updated
	instructions about this.

     ii) Unlike with the CUPS native driver, there is no simple way to
	update all PPD files when you install a new version of
	Gutenprint.  You must either use the foomatic-ppdfile command
	to upgrade PPD files individually, or foomatic-compiledb to
	build all PPD files.  Your system may provide an alternate way
	to install new PPD files, in which case you may use that
	method.

     iii) The Foomatic data is version locked to the Gutenprint release
	installed on the system.  For example, PPD files generated
	with the Foomatic data for release 5.0.0 will not work with
	the ijsgutenprint in release 5.0.1.  This is to prevent
	accidentally using incorrect data, which could cause incorrect
	function to take place.

  4) There is a known complication building "escputil" that causes
     problems on some systems.  "escputil" uses the "readline"
     package, to support command editing and history within the
     program.  Unfortunately, linking programs with "readline" often
     requires linking against additional libraries, and the exact
     library depends upon the system (e. g. not all Linux systems have
     the same requirements).

     The configure script attempts to determine which additional
     library must be linked against.  It tries using the following
     libraries in this order to build a test executable:

     -lncurses
     -lcurses
     -ltermcap
     no additional libraries

     The reason it tries other libraries first is that some systems
     will link successfully, but only fail when an attempt is made to
     actually call readline.  Therefore, we assume that additional
     libraries are required.  Since we try the extra libraries in
     order from most recent to oldest, we expect that the first one we
     find will be appropriate.  For example, if the "ncurses" library
     is the standard on a given system, the "termcap" library may be
     provided for back compatibility, but it is unlikely that
     "termcap" will be the standard with "curses" or "ncurses" being
     provided for compatibility only (so that the link will succeed
     but the command will use the incorrect library).

     As this procedure is not failsafe, we provide the following
     configure options to control this behavior:

     ./configure --with-readline=yes  (the default; attempts to
				      determine the correct library
				      to link against)

     ./configure --with-readline=no   (turns off use of readline
				      altogether)

     ./configure --with-readline=only (specifically instructs
				      configure to not attempt to
				      link against any other
				      libraries)

     ./configure --with-readline=libs (specifies the libraries to be
				      linked against)

     An hypothetical (this won't work anywhere!) example of the
     latter would be

     ./configure --with-readline='-lncurses -ltermcap'

     Note that configure will not allow readline to be used if it
     cannot successfully build the test program, regardless of the
     option selected.  If you are having difficulty getting escputil
     to build, we suggest using --with-readline=no.  The commands
     used within escputil are very short and seldom require
     significant editing.

  5) The fix for bug 929227 (Gimp-Print incorrectly attempts to build
     against GIMP 2.0) requires special build instructions if you are
     using a very old version of the GIMP 1.2 (1.2.0, 1.2.1, or
     1.2.2).  Specifically, you must set GIMPTOOL in the environment
     to point to the proper version of gimptool when running
     Gutenprint's configure script.  For example:

     GIMPTOOL=/usr/bin/gimptool ./configure

     The bug fix involves checking for the presence of the GIMP
     slightly differently from how it was previously done.
     Previously, Gimp-Print checked for the presence of a program
     named "gimptool", which provides information about how to build
     plugins against the GIMP.  This worked correctly when only the
     GIMP 1.2 was installed, but not when the GIMP 2.0 was installed.

     The GIMP 2.0 actually installs a program named "gimptool-2.0",
     and creates a symbolic link named "gimptool" pointing to it.
     Later versions of the GIMP 1.2 (1.2.3, 1.2.4, 1.2.5, and any
     later versions that may be released) similarly create a program
     named "gimptool-1.2" and a symbolic link named "gimptool".  As
     the configure script prior to this bug fix simply checked for
     gimptool, it incorrectly detected a gimptool from the GIMP 2.0.

     The current configure script checks first for gimptool-1.2 and
     then for gimptool, and only accepts the use of a GIMP 1.2 version
     of one of these programs.  However, if you have one of the older
     versions of the GIMP 1.2 installed in a non-standard location,
     and you use --with-gimp-prefix or --with-gimp-exec-prefix to
     specify its location, the configure script will not automatically
     detect the correct location of gimptool, and you must specify it
     as described above.  Note that you must specify a copy of
     gimptool from the GIMP 1.2, not from the GIMP 2.0.  If your copy
     of the GIMP is installed in a standard location (typically
     /usr/bin or /usr/local/bin), you do not need to use
     --with-gimp-prefix or --with-gimp-exec-prefix, and therefore do
     not need to use this workaround.

     If you cannot upgrade to the GIMP 2.x, the Gutenprint and GIMP
     projects recommend upgrading to revision of the GIMP 1.2.5, which
     will not require this workaround.  This workaround is available
     in the event that you cannot or do not wish to upgrade your
     installation of the GIMP.
